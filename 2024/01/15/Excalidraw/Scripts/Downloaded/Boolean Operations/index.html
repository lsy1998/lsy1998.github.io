<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>一人喃喃，群山回响 | 一人喃喃，群山回响</title><meta name="author" content="李商隐"><meta name="copyright" content="李商隐"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="&#x2F;*With This Script it is possible to make boolean Operations on Shapes.The style of the resulting shape will be the style of the highest ranking Element that was used.The ranking of the elemtns is bas">
<meta property="og:type" content="article">
<meta property="og:title" content="一人喃喃，群山回响">
<meta property="og:url" content="https://lsy1998.top/2024/01/15/Excalidraw/Scripts/Downloaded/Boolean%20Operations/index.html">
<meta property="og:site_name" content="一人喃喃，群山回响">
<meta property="og:description" content="&#x2F;*With This Script it is possible to make boolean Operations on Shapes.The style of the resulting shape will be the style of the highest ranking Element that was used.The ranking of the elemtns is bas">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://foruda.gitee.com/avatar/1676993386051995312/1867919_longsiyu_1599210190.png">
<meta property="article:published_time" content="2024-01-15T10:12:44.137Z">
<meta property="article:modified_time" content="2023-10-08T09:57:21.610Z">
<meta property="article:author" content="李商隐">
<meta property="article:tag" content="李商隐的blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://foruda.gitee.com/avatar/1676993386051995312/1867919_longsiyu_1599210190.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://lsy1998.top/2024/01/15/Excalidraw/Scripts/Downloaded/Boolean%20Operations/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="pScwDdbO_uzOcgoC-i5YNANrNKjUSReGs-Nv60_XT2g"/><meta name="google-site-verification" content="eNW6IbsYJdamX6AiwXlXB0ppZ6k9XoURniueq11WQY8"/><meta name="msvalidate.01" content="CD83E1BE40EC7D52B0CEBD498830DA17"/><meta name="baidu-site-verification" content="codeva-HhaWKLFYiT"/><meta name="baidu_union_verify" content="4930a431a713328dc9bd4192bd32373a"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"简","msgToSimplifiedChinese":"繁"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 李商隐","link":"链接: ","source":"来源: 一人喃喃，群山回响","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '一人喃喃，群山回响',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-10-08 17:57:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://foruda.gitee.com/avatar/1676993386051995312/1867919_longsiyu_1599210190.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">58</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="一人喃喃，群山回响"><span class="site-name">一人喃喃，群山回响</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">无题<a class="post-edit-link" href="https://github.com/lsy1998/lsy1998.github.io/edit/master/source/_posts/Excalidraw/Scripts/Downloaded/Boolean Operations.md" rel="external nofollow noreferrer" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-01-15T10:12:44.137Z" title="发表于 2024-01-15 18:12:44">2024-01-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-08T09:57:21.610Z" title="更新于 2023-10-08 17:57:21">2023-10-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Excalidraw/">Excalidraw</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Excalidraw/Scripts/">Scripts</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Excalidraw/Scripts/Downloaded/">Downloaded</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>9分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>/*<br>With This Script it is possible to make boolean Operations on Shapes.<br>The style of the resulting shape will be the style of the highest ranking Element that was used.<br>The ranking of the elemtns is based on their background. The “denser” the background, the higher the ranking (the order of backgroundstyles is shown below). If they have the same background the opacity will decide. If thats also the same its decided by the order they were created.<br>The ranking is also important for the diffrence operation, so a tranparent object for example will cut a hole into a solid object.<br><img src="https://raw.githubusercontent.com/zsviczian/obsidian-excalidraw-plugin/master/images/scripts-boolean-operations-showcase.png"><br><img src="https://raw.githubusercontent.com/zsviczian/obsidian-excalidraw-plugin/master/images/scripts-boolean-operations-element-ranking.png"></p>
<p>See documentation for more details:<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://zsviczian.github.io/obsidian-excalidraw-plugin/ExcalidrawScriptsEngine.html">https://zsviczian.github.io/obsidian-excalidraw-plugin/ExcalidrawScriptsEngine.html</a></p>
<pre><code class="javascript">*/
if(!ea.verifyMinimumPluginVersion || !ea.verifyMinimumPluginVersion(&quot;1.9.20&quot;)) &#123;
  new Notice(&quot;This script requires a newer version of Excalidraw. Please install the latest version.&quot;);
  return;
&#125;
const ShadowGroupMarker = &quot;ShadowCloneOf-&quot;;

const elements = ea.getViewSelectedElements().filter(
  el=&gt;[&quot;ellipse&quot;, &quot;rectangle&quot;, &quot;diamond&quot;].includes(el.type) ||
    el.groupIds.some(id =&gt; id.startsWith(ShadowGroupMarker)) ||
    ([&quot;line&quot;, &quot;arrow&quot;].includes(el.type) &amp;&amp; el.roundness === null)
);
if(elements.length === 0) &#123;
  new Notice (&quot;Select ellipses, rectangles or diamonds&quot;);
  return;
&#125;

const PolyBool = ea.getPolyBool();
const polyboolAction = await utils.suggester([&quot;union (a + b)&quot;, &quot;intersect (a &amp;&amp; b)&quot;, &quot;diffrence (a - b)&quot;, &quot;reversed diffrence (b - a)&quot;, &quot;xor&quot;], [
  PolyBool.union, PolyBool.intersect, PolyBool.difference, PolyBool.differenceRev, PolyBool.xor
], &quot;What would you like todo with the object&quot;);

const shadowClones = elements.filter(element =&gt; element.groupIds.some(id =&gt; id.startsWith(ShadowGroupMarker)));
shadowClones.forEach(shadowClone =&gt; &#123;
  let parentId = shadowClone.groupIds
    .filter(id =&gt; id.startsWith(ShadowGroupMarker))[0]
    .slice(ShadowGroupMarker.length);
  const shadowCloneIndex = elements.findIndex(element =&gt; element.id == parentId);
  if (shadowCloneIndex == -1) return;
  elements[shadowCloneIndex].backgroundColor = shadowClone.backgroundColor;
  elements[shadowCloneIndex].fillStyle = shadowClone.fillStyle;
&#125;)
const borderElements = elements.filter(element =&gt; !element.groupIds.some(id =&gt; id.startsWith(ShadowGroupMarker)));
groups = ea.getMaximumGroups(borderElements);
groups = groups.map((group) =&gt; group.sort((a, b) =&gt; RankElement(b) - RankElement(a)));
groups.sort((a, b) =&gt; RankElement(b[0]) - RankElement(a[0]));

ea.style.strokeColor = groups[0][0].strokeColor;
ea.style.backgroundColor = groups[0][0].backgroundColor;
ea.style.fillStyle = groups[0][0].fillStyle;
ea.style.strokeWidth = groups[0][0].strokeWidth;
ea.style.strokeStyle = groups[0][0].strokeStyle;
ea.style.roughness = groups[0][0].roughness;
ea.style.opacity = groups[0][0].opacity;

const basePolygons = groups.shift().map(element =&gt; traceElement(element));
const toolPolygons = groups.flatMap(group =&gt; group.map(element =&gt; traceElement(element)));

const result = polyboolAction(&#123;
  regions: basePolygons,
  inverted: false
&#125;, &#123;
  regions: toolPolygons,
  inverted: false
&#125;);
const polygonHierachy = subordinateInnerPolygons(result.regions);
drawPolygonHierachy(polygonHierachy);
ea.deleteViewElements(elements);
ea.addElementsToView(false,false,true);
return;



function traceElement(element) &#123;
  const diamondPath = (diamond) =&gt; [
      SxVEC(1/2, [0, diamond.height]),
      SxVEC(1/2, [diamond.width, 0]),
      addVec([SxVEC(1/2, [0, diamond.height]), ([diamond.width, 0])]),
      addVec([SxVEC(1/2, [diamond.width, 0]), ([0, diamond.height])]),
      SxVEC(1/2, [0, diamond.height])
    ];
  const rectanglePath = (rectangle) =&gt; [
    [0,0],
    [0, rectangle.height],
    [rectangle.width, rectangle.height],
    [rectangle.width, 0],
    [0, 0]
  ]
  const ellipsePath = (ellipse) =&gt; &#123;
    const angle = ellipse.angle;
    const width = ellipse.width;
    const height = ellipse.height;
    const ellipseAtPoint = (t) =&gt; &#123;
      const spanningVector = [width/2*Math.cos(t), height/2*Math.sin(t)];
      const baseVector = [width/2, height/2];
      return addVec([spanningVector, baseVector]);
    &#125;
    let points = [];
    step = (2*Math.PI)/64
    for (let t = 0; t &lt; 2*Math.PI; t = t + step) &#123;
      points.push(ellipseAtPoint(t));
    &#125;
    return points;
  &#125;
  let polygon;
  let correctForPolygon = [0, 0];
  switch (element.type) &#123;
    case &quot;diamond&quot;:
      polygon = diamondPath(element);
      break;
    case &quot;rectangle&quot;:
      polygon = rectanglePath(element);
      break;
    case &quot;ellipse&quot;:
      polygon = ellipsePath(element);
      break;
    case &quot;line&quot;:
    case &quot;arrow&quot;:
      if (element.angle != 0) &#123;
        let smallestX = 0;
        let smallestY = 0;
        element.points.forEach(point =&gt; &#123;
          if (point[0] &lt; smallestX) smallestX = point[0];
          if (point[1] &lt; smallestY) smallestY = point[1];
        &#125;);
        polygon = element.points.map(point =&gt; &#123;
          return [
            point[0] -= smallestX,
            point[1] -= smallestY
          ];
        &#125;);
        correctForPolygon = [smallestX, smallestY];
        break;
      &#125;
      if (element.roundness) &#123;
        new Notice(&quot;This script does not work with curved lines or arrows yet!&quot;);
        return [];
      &#125;
      polygon = element.points; 
      default:
          break;
    &#125;
  if (element.angle == 0) return polygon.map(v =&gt; addVec([v, [element.x, element.y]]));
  
  polygon = polygon.map(v =&gt; addVec([v, SxVEC(-1/2, [element.width, element.height])]));
  polygon = rotateVectorsByAngle(polygon, element.angle);
  return polygon.map(v =&gt; addVec([v, [element.x, element.y], SxVEC(1/2, [element.width, element.height]), correctForPolygon]));
&#125;

function RankElement(element) &#123;
  let score = 0;
  const backgroundRank = [
    &quot;dashed&quot;,
    &quot;none&quot;,
    &quot;hachure&quot;,
    &quot;zigzag&quot;,
    &quot;zigzag-line&quot;,
    &quot;cross-hatch&quot;,
    &quot;solid&quot;
  ]
  score += (backgroundRank.findIndex((fillStyle) =&gt; fillStyle == element.fillStyle) + 1) * 10;
  if (element.backgroundColor == &quot;transparent&quot;) score -= 100;
  if (element.points &amp;&amp; getVectorLength(element.points[element.points.length - 1]) &gt; 8) score -= 100; 
  if (score &lt; 0) score = 0;
  score += element.opacity / 100;
  return score;
&#125;

function drawPolygonHierachy(polygonHierachy) &#123;
  const backgroundColor = ea.style.backgroundColor;
  const strokeColor = ea.style.strokeColor;
  const setInnerStyle = () =&gt; &#123;
    ea.style.backgroundColor = backgroundColor;
    ea.style.strokeColor = &quot;transparent&quot;;
  &#125;
  const setBorderStyle = () =&gt; &#123;
    ea.style.backgroundColor = &quot;transparent&quot;;
    ea.style.strokeColor = strokeColor;
  &#125;
  const setFilledStyle = () =&gt; &#123;
    ea.style.backgroundColor = backgroundColor;
    ea.style.strokeColor = strokeColor;
  &#125;
  
  polygonHierachy.forEach(polygon =&gt; &#123;
    setFilledStyle();
    let path = polygon.path;
    path.push(polygon.path[0]);
    if (polygon.innerPolygons.length === 0) &#123;
      ea.addLine(path);
      return;
    &#125;
    const outerBorder = path;
    const innerPolygons = addInnerPolygons(polygon.innerPolygons);
    path = path.concat(innerPolygons.backgroundPath);
    path.push(polygon.path[0]);
    setInnerStyle();
    const backgroundId = ea.addLine(path);
    setBorderStyle();
    const outerBorderId = ea.addLine(outerBorder)
    const innerBorderIds = innerPolygons.borderPaths.map(path =&gt; ea.addLine(path));
    const allIds = [innerBorderIds, outerBorderId, backgroundId].flat();
    ea.addToGroup(allIds);
    const background = ea.getElement(backgroundId);
    background.groupIds.push(ShadowGroupMarker + outerBorderId);
  &#125;);
&#125;

function addInnerPolygons(polygonHierachy) &#123;
  let firstPath = [];
  let secondPath = [];
  let borderPaths = [];
  polygonHierachy.forEach(polygon =&gt; &#123;
    let path = polygon.path;
    path.push(polygon.path[0]);
    borderPaths.push(path);
    firstPath = firstPath.concat(path);
    secondPath.push(polygon.path[0]);
    drawPolygonHierachy(polygon.innerPolygons);
  &#125;);
  return &#123;
    backgroundPath: firstPath.concat(secondPath.reverse()), 
    borderPaths: borderPaths
  &#125;;
&#125;

function subordinateInnerPolygons(polygons) &#123;
  const polygonObjectPrototype = (polygon) =&gt; &#123;
    return &#123;
      path: polygon,
      innerPolygons: []
    &#125;;
  &#125;

  const insertPolygonIntoHierachy = (polygon, hierarchy) =&gt; &#123;
    for (let i = 0; i &lt; hierarchy.length; i++) &#123;
      const polygonObject = hierarchy[i];
      let inside = null;
      let pointIndex = 0;
      do &#123;
        inside = pointInPolygon(polygon[pointIndex], polygonObject.path);
        pointIndex++
      &#125; while (inside === null);
      if (inside) &#123;
        hierarchy[i].innerPolygons = insertPolygonIntoHierachy(polygon, hierarchy[i].innerPolygons);
        return hierarchy;
      &#125;
    &#125;
    polygon = polygonObjectPrototype(polygon);
    for (let i = 0; i &lt; hierarchy.length; i++) &#123;
      const polygonObject = hierarchy[i];
      let inside = null;
      let pointIndex = 0;
      do &#123;
        inside = pointInPolygon(polygonObject.path[pointIndex], polygon.path);
        pointIndex++
      &#125; while (inside === null);
      if (inside) &#123;
        polygon.innerPolygons.push(hierarchy.splice(i, 1)[0]);
        i--;
      &#125;
    &#125;
    hierarchy.push(polygon);
    return hierarchy;
  &#125;

  let polygonHierachy = [];
  polygons.forEach(polygon =&gt; &#123;
    polygonHierachy = insertPolygonIntoHierachy(polygon, polygonHierachy);
  &#125;)

  return polygonHierachy;
&#125;

/**
 * Checks if the given point lays in the polygon
 * @param point array [x, y]
 * @param polygon array [[x, y], ...]
 * @returns true if inside, false if not, null if the point is on one of the polygons vertecies
 */
function pointInPolygon(point, polygon) &#123;
  const x = point[0];
  const y = point[1];
  let inside = false;

  // odd even test if point is in polygon
  for (let i = 0, j = polygon.length - 1; i &lt; polygon.length; j = i++) &#123;
    const xi = polygon[i][0];
    const yi = polygon[i][1];
    const xj = polygon[j][0];
    const yj = polygon[j][1];

    const intersect =
      yi &gt; y !== yj &gt; y &amp;&amp;
      x &lt; ((xj - xi) * (y - yi)) / (yj - yi) + xi;

    if (intersect) &#123;
      inside = !inside;
    &#125;

    if ((x === xi &amp;&amp; y === yi) || (x === xj &amp;&amp; y === yj)) &#123;
      return null;
    &#125;
  &#125;

  return inside;
&#125;


function getVectorLength(vector) &#123;
  return Math.sqrt(vector[0]**2+vector[1]**2);
&#125;

/**
 * Adds two Vectors together
 */
function addVec(vectors) &#123;
  return vectors.reduce((acc, vec) =&gt; [acc[0] + vec[0], acc[1] + vec[1]], [0, 0]);
&#125;

/**
 * Returns the negative of the vector
 */
function negVec(vector) &#123;
  return [-vector[0], -vector[1]];
&#125;
 
/**
 * Multiplies Vector with a scalar
 */
function SxVEC(scalar, vector) &#123;
  return [vector[0] * scalar, vector[1] * scalar];
&#125;

function rotateVector (vec, ang)  &#123;
  var cos = Math.cos(ang);
  var sin = Math.sin(ang);
  return [vec[0] * cos - vec[1] * sin, vec[0] * sin + vec[1] * cos];
&#125;

function rotateVectorsByAngle(vectors, angle) &#123;
  const cosAngle = Math.cos(angle);
  const sinAngle = Math.sin(angle);

  const rotationMatrix = [
    [cosAngle, -sinAngle],
    [sinAngle, cosAngle]
  ];

  return applyTranformationMatrix(vectors, rotationMatrix);
&#125;

function applyTranformationMatrix(vectors, transformationMatrix) &#123;
  const result = [];
  for (const vector of vectors) &#123;
    const x = vector[0];
    const y = vector[1];

    const newX = transformationMatrix[0][0] * x + transformationMatrix[0][1] * y;
    const newY = transformationMatrix[1][0] * x + transformationMatrix[1][1] * y;

    result.push([newX, newY]);
  &#125;

  return result;
&#125;
</code></pre>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://lsy1998.top">李商隐</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://lsy1998.top/2024/01/15/Excalidraw/Scripts/Downloaded/Boolean%20Operations/">https://lsy1998.top/2024/01/15/Excalidraw/Scripts/Downloaded/Boolean%20Operations/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lsy1998.top" target="_blank">一人喃喃，群山回响</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-60d83250dbee0f37" async="async"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://foruda.gitee.com/avatar/1676993386051995312/1867919_longsiyu_1599210190.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://foruda.gitee.com/avatar/1676993386051995312/1867919_longsiyu_1599210190.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://foruda.gitee.com/avatar/1676993386051995312/1867919_longsiyu_1599210190.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://foruda.gitee.com/avatar/1676993386051995312/1867919_longsiyu_1599210190.png" alt="支付包"/></a><div class="post-qr-code-desc">支付包</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/15/Excalidraw/Scripts/Downloaded/Change%20shape%20of%20selected%20elements/" title=""><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info"></div></div></a></div><div class="next-post pull-right"><a href="/2024/01/15/Excalidraw/Scripts/Downloaded/Auto%20Layout/" title=""><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info"></div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://foruda.gitee.com/avatar/1676993386051995312/1867919_longsiyu_1599210190.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">李商隐</div><div class="author-info__description">李商隐的博客</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">58</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://gitee.com/longsiyu"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lsy1998" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:siyu.long@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/17/SimpRead/7-%E4%B8%BA%E4%BB%80%E4%B9%88%20Bun%20%E5%8F%AF%E8%83%BD%E5%AF%B9%20Node%20%E9%99%8D%E7%BB%B4%E6%89%93%E5%87%BB%EF%BC%9F@annote/" title="为什么 Bun 可能对 Node 降维打击？">为什么 Bun 可能对 Node 降维打击？</a><time datetime="2024-02-17T08:19:28.706Z" title="发表于 2024-02-17 16:19:28">2024-02-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/17/SimpRead/%E4%B8%BA%E4%BB%80%E4%B9%88%20Bun%20%E5%8F%AF%E8%83%BD%E5%AF%B9%20Node%20%E9%99%8D%E7%BB%B4%E6%89%93%E5%87%BB%EF%BC%9F/" title="为什么 Bun 可能对 Node 降维打击？">为什么 Bun 可能对 Node 降维打击？</a><time datetime="2024-02-17T08:19:04.000Z" title="发表于 2024-02-17 16:19:04">2024-02-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/17/SimpRead/6-Obsidian%20%E7%BD%91%E9%A1%B5%E5%89%AA%E8%A3%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88@annote/" title="Obsidian 网页剪裁解决方案">Obsidian 网页剪裁解决方案</a><time datetime="2024-02-17T05:38:53.642Z" title="发表于 2024-02-17 13:38:53">2024-02-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/17/SimpRead/5-Obsidian%20%E7%BB%BC%E8%BF%B0%20-%20%E6%96%B0%20UI%20%E6%96%B0%E5%BE%81%E7%A8%8B%EF%BC%88v0_16%20%E5%8F%91%E5%B8%83%E4%B9%8B%E9%99%85%EF%BC%89@annote/" title="Obsidian 综述 - 新 UI 新征程（v0_16 发布之际）">Obsidian 综述 - 新 UI 新征程（v0_16 发布之际）</a><time datetime="2024-02-17T05:38:53.639Z" title="发表于 2024-02-17 13:38:53">2024-02-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/17/SimpRead/4-%E7%9C%8B%E6%9D%BF%E3%80%81%E5%8F%8C%E5%90%91%E9%93%BE%E6%8E%A5%E3%80%81%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E2%80%A6%E2%80%A6%20%E7%AE%80%E6%82%A6%202-2%20%E6%83%B3%E8%AE%A9%E4%BD%A0%E7%9A%84%E7%A8%8D%E5%90%8E%E8%AF%BB%E4%B8%8D%E5%86%8D%E4%B8%8D%E8%AF%BB@annote/" title="看板、双向链接、知识图谱…… 简悦 2-2 想让你的稍后读不再不读">看板、双向链接、知识图谱…… 简悦 2-2 想让你的稍后读不再不读</a><time datetime="2024-02-17T05:38:53.637Z" title="发表于 2024-02-17 13:38:53">2024-02-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By 李商隐</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://lsytwikoo.zeabur.app/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://lsytwikoo.zeabur.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.textContent = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><div class="aplayer no-destroy" data-id="2482869238" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8415562851507550" crossorigin="anonymous"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>